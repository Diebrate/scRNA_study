}
pp_df1 <- data.frame(pp_df1)
colnames(pp_df1) <- pennLC.sf$county
head(pp_df1)
hist(pp_df1$centre, main='centre', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='centre'))$counts)
pp_df1 <- matrix(0, ncol=nd, nrow=100)
for(i in 1:100){
b0 <- rnorm(n=1, mean=res1$summary.fixed[1, "mean"], sd=res1$summary.fixed[1, "sd"])
b1 <- rnorm(n=1, mean=res1$summary.fixed[2, "mean"], sd=res1$summary.fixed[2, "sd"])
u <- rnorm(n=nd,
mean=res1$summary.random$re_u[, "mean"],
sd=res1$summary.random$re_u[, "sd"])
v <- rnorm(n=nd,
mean=res1$summary.random$re_v[, "mean"],
sd=res1$summary.random$re_v[, "sd"])
pp_df1[i, ] <- rpois(n=nd, lambda=exp(b0 + b1 * pennLC.sf$smoking + u + v) * E)
}
pp_df1 <- data.frame(pp_df1)
colnames(pp_df1) <- pennLC.sf$county
head(pp_df1)
hist(pp_df1$centre, main='centre', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='centre'))$counts)
pp_df1 <- matrix(0, ncol=nd, nrow=100)
for(i in 1:100){
b0 <- rnorm(n=1, mean=res1$summary.fixed[1, "mean"], sd=res1$summary.fixed[1, "sd"])
b1 <- rnorm(n=1, mean=res1$summary.fixed[2, "mean"], sd=res1$summary.fixed[2, "sd"])
u <- rnorm(n=nd,
mean=res1$summary.random$re_u[, "mean"],
sd=res1$summary.random$re_u[, "sd"])
v <- rnorm(n=nd,
mean=res1$summary.random$re_v[, "mean"],
sd=res1$summary.random$re_v[, "sd"])
pp_df1[i, ] <- rpois(n=nd, lambda=exp(b0 + b1 * pennLC.sf$smoking + u + v) * E)
}
pp_df1 <- data.frame(pp_df1)
colnames(pp_df1) <- pennLC.sf$county
head(pp_df1)
hist(pp_df1$centre, main='centre', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='centre'))$counts)
hist(pp_df1$monroe, main='monroe', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='monroe'))$counts)
hist(pp_df1$westmoreland, main='westmoreland', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='westmoreland'))$counts)
hist(pp_df1$lebanon, main='lebanon', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='lebanon'))$counts)
hist(pp_df1$beaver, main='beaver', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='beaver'))$counts)
hist(pp_df1$erie, main='erie', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='erie'))$counts)
pp_df2 <- matrix(0, ncol=nd, nrow=100)
for(i in 1:100){
b0 <- rnorm(n=1, mean=res2$summary.fixed[1, "mean"], sd=res2$summary.fixed[1, "sd"])
b1 <- rnorm(n=1, mean=res2$summary.fixed[2, "mean"], sd=res2$summary.fixed[2, "sd"])
u <- rnorm(n=nd,
mean=res2$summary.random$re_u[, "mean"],
sd=res2$summary.random$re_u[, "sd"])
v <- rnorm(n=nd,
mean=res2$summary.random$re_v[, "mean"],
sd=res2$summary.random$re_v[, "sd"])
pp_df2[2, ] <- rpois(n=nd, lambda=exp(b0 + b1 * pennLC.sf$smoking + u + v) * E)
}
pp_df2 <- data.frame(pp_df2)
colnames(pp_df2) <- pennLC.sf$county
head(pp_df2)
hist(pp_df2$centre, main='centre', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='centre'))$counts)
hist(pp_df2$monroe, main='monroe', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='monroe'))$counts)
hist(pp_df2$westmoreland, main='westmoreland', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='westmoreland'))$counts)
hist(pp_df2$lebanon, main='lebanon', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='lebanon'))$counts)
hist(pp_df2$beaver, main='beaver', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='beaver'))$counts)
hist(pp_df2$erie, main='erie', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='erie'))$counts)
pp_df3 <- matrix(0, ncol=nd, nrow=100)
for(i in 1:100){
b0 <- rnorm(n=1, mean=res3$summary.fixed[1, "mean"], sd=res3$summary.fixed[1, "sd"])
b1 <- rnorm(n=1, mean=res3$summary.fixed[2, "mean"], sd=res3$summary.fixed[2, "sd"])
u <- rnorm(n=nd,
mean=res3$summary.random$re_u[, "mean"],
sd=res3$summary.random$re_u[, "sd"])
v <- rnorm(n=nd,
mean=res3$summary.random$re_v[, "mean"],
sd=res3$summary.random$re_v[, "sd"])
pp_df3[i, ] <- rpois(n=nd, lambda=exp(b0 + b1 * pennLC.sf$smoking + u + v) * E)
}
pp_df3 <- data.frame(pp_df3)
colnames(pp_df3) <- pennLC.sf$county
head(pp_df3)
hist(pp_df3$centre, main='centre', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='centre'))$counts)
hist(pp_df3$monroe, main='monroe', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='monroe'))$counts)
hist(pp_df3$westmoreland, main='westmoreland', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='westmoreland'))$counts)
hist(pp_df3$lebanon, main='lebanon', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='lebanon'))$counts)
hist(pp_df3$beaver, main='beaver', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='beaver'))$counts)
hist(pp_df3$erie, main='erie', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='erie'))$counts)
pp_df2 <- matrix(0, ncol=nd, nrow=100)
for(i in 1:100){
b0 <- rnorm(n=1, mean=res2$summary.fixed[1, "mean"], sd=res2$summary.fixed[1, "sd"])
b1 <- rnorm(n=1, mean=res2$summary.fixed[2, "mean"], sd=res2$summary.fixed[2, "sd"])
u <- rnorm(n=nd,
mean=res2$summary.random$re_u[, "mean"],
sd=res2$summary.random$re_u[, "sd"])
v <- rnorm(n=nd,
mean=res2$summary.random$re_v[, "mean"],
sd=res2$summary.random$re_v[, "sd"])
pp_df2[2, ] <- rpois(n=nd, lambda=exp(b0 + b1 * pennLC.sf$smoking + u + v) * E)
}
pp_df2 <- data.frame(pp_df2)
colnames(pp_df2) <- pennLC.sf$county
head(pp_df2)
hist(pp_df2$centre, main='centre', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='centre'))$counts)
hist(pp_df2$monroe, main='monroe', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='monroe'))$counts)
hist(pp_df2$westmoreland, main='westmoreland', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='westmoreland'))$counts)
hist(pp_df2$lebanon, main='lebanon', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='lebanon'))$counts)
hist(pp_df2$beaver, main='beaver', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='beaver'))$counts)
hist(pp_df2$erie, main='erie', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='erie'))$counts)
res2$summary.fixe
res1$summary.fixe
res1$summary.random
res2$summary.random
res2$summary.random$re_v[, "mean"]
res1$summary.random$re_v[, "mean"]
pp_df2 <- matrix(0, ncol=nd, nrow=100)
for(i in 1:100){
b0 <- rnorm(n=1, mean=res2$summary.fixed[1, "mean"], sd=res2$summary.fixed[1, "sd"])
b1 <- rnorm(n=1, mean=res2$summary.fixed[2, "mean"], sd=res2$summary.fixed[2, "sd"])
u <- rnorm(n=nd,
mean=res2$summary.random$re_u[, "mean"],
sd=res2$summary.random$re_u[, "sd"])
v <- rnorm(n=nd,
mean=res2$summary.random$re_v[, "mean"],
sd=res2$summary.random$re_v[, "sd"])
pp_df2[i, ] <- rpois(n=nd, lambda=exp(b0 + b1 * pennLC.sf$smoking + u + v) * E)
}
pp_df2 <- data.frame(pp_df2)
colnames(pp_df2) <- pennLC.sf$county
head(pp_df2)
hist(pp_df2$centre, main='centre', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='centre'))$counts)
hist(pp_df2$monroe, main='monroe', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='monroe'))$counts)
hist(pp_df2$westmoreland, main='westmoreland', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='westmoreland'))$counts)
hist(pp_df2$lebanon, main='lebanon', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='lebanon'))$counts)
hist(pp_df2$beaver, main='beaver', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='beaver'))$counts)
hist(pp_df2$erie, main='erie', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='erie'))$counts)
tmap_mode("plot")
pennLC_temp <- pennLC.sf %>% mutate(ppdraw=c(t(pp_df1[1,])))
tm_shape(pennLC_temp) +
tm_polygons("ppdraw")
pennLC_temp <- pennLC.sf %>% mutate(ppdraw=c(t(pp_df1[2,])))
tm_shape(pennLC_temp) +
tm_polygons("ppdraw")
pennLC_temp <- pennLC.sf %>% mutate(ppdraw=c(t(pp_df1[3,])))
tm_shape(pennLC_temp) +
tm_polygons("ppdraw")
pennLC_temp <- pennLC.sf %>% mutate(ppdraw=c(t(pp_df1[4,])))
tm_shape(pennLC_temp) +
tm_polygons("ppdraw")
tmap_mode("plot")
pennLC_temp <- pennLC.sf %>% mutate(ppdraw=c(t(pp_df2[1,])))
tm_shape(pennLC_temp) +
tm_polygons("ppdraw")
pennLC_temp <- pennLC.sf %>% mutate(ppdraw=c(t(pp_df2[2,])))
tm_shape(pennLC_temp) +
tm_polygons("ppdraw")
pennLC_temp <- pennLC.sf %>% mutate(ppdraw=c(t(pp_df2[3,])))
tm_shape(pennLC_temp) +
tm_polygons("ppdraw")
pennLC_temp <- pennLC.sf %>% mutate(ppdraw=c(t(pp_df2[4,])))
tm_shape(pennLC_temp) +
tm_polygons("ppdraw")
tmap_mode("plot")
pennLC_temp <- pennLC.sf %>% mutate(ppdraw=c(t(pp_df3[1,])))
tm_shape(pennLC_temp) +
tm_polygons("ppdraw")
pennLC_temp <- pennLC.sf %>% mutate(ppdraw=c(t(pp_df3[2,])))
tm_shape(pennLC_temp) +
tm_polygons("ppdraw")
pennLC_temp <- pennLC.sf %>% mutate(ppdraw=c(t(pp_df3[3,])))
tm_shape(pennLC_temp) +
tm_polygons("ppdraw")
pennLC_temp <- pennLC.sf %>% mutate(ppdraw=c(t(pp_df3[4,])))
tm_shape(pennLC_temp) +
tm_polygons("ppdraw")
df1 <- matrix(nrow=100, ncol=nd)
for(i in 1:100){
b0 <- rnorm(n=1, mean=0, sd=1)
b1 <- rnorm(n=1, mean=0, sd=1)
tau_nu <- rgamma(n=1, shape=1, scale=1)
tau_mu <- rgamma(n=1, shape=1, scale=1)
mu <- mvrnorm(n=1, mu=rep(0, nd), Sigma=diag(rep(1, nd)))
log_theta <- b0 + b1 * pennLC.sf$smoking +
get_mu(tau_mu, W, d$x, mu) + rnorm(n=nd, mean=0, sd=1/sqrt(tau_nu))
y <- rpois(n=nd, lambda=exp(log_theta) * E)
df1[i, ] <- y
}
df1 <- data.frame(df1)
colnames(df1) <- pennLC.sf$county
head(df1)
# the largest 20% are trimmed to avoid extreme values
v <- sort(df1$centre, TRUE)[20:100]
hist(v[v <= 10000], main='centre', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='centre'))$counts)
v <- sort(df1$monroe, TRUE)[20:100]
hist(v[v <= 10000], main='monroe', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='monroe'))$counts)
v <- sort(df1$westmoreland)[20:100]
hist(v[v <= 10000], main='westmoreland', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='westmoreland'))$counts)
v <- sort(df1$lebanon, TRUE)[20:100]
hist(v[v <= 10000], main='lebanon', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='lebanon'))$counts)
v <- sort(df1$beaver, TRUE)[20:100]
hist(v[v <= 10000], main='beaver', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='beaver'))$counts)
v <- sort(df1$erie, TRUE)[20:100]
hist(v[v <= 10000], main='erie', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='erie'))$counts)
df2 <- matrix(nrow=100, ncol=nd)
for(i in 1:100){
b0 <- rnorm(n=1, mean=0, sd=100)
b1 <- rnorm(n=1, mean=0, sd=100)
tau_nu <- rgamma(n=1, shape=0.1, scale=0.1)
tau_mu <- rgamma(n=1, shape=0.1, scale=0.1)
mu <- mvrnorm(n=1, mu=rep(0, nd), Sigma=diag(rep(1, nd)))
log_theta <- b0 + b1 * pennLC.sf$smoking +
get_mu(tau_mu, W, d$x, mu) + rnorm(n=nd, mean=0, sd=1/sqrt(tau_nu))
y <- rpois(n=nd, lambda=exp(log_theta) * E)
df2[i, ] <- y
}
# This is not a good prior since tau_mu tends to yield extreme log_theta.
# Many draws are infinitely large.
df2 <- data.frame(df2)
colnames(df2) <- pennLC.sf$county
head(df2)
hist(df2$centre, main='centre', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='centre'))$counts)
hist(df2$monroe, main='monroe', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='monroe'))$counts)
hist(df2$westmoreland, main='westmoreland', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='westmoreland'))$counts)
hist(df2$lebanon, main='lebanon', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='lebanon'))$counts)
hist(df2$beaver, main='beaver', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='beaver'))$counts)
hist(df2$erie, main='erie', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='erie'))$counts)
df1 <- matrix(nrow=100, ncol=nd)
for(i in 1:100){
b0 <- rnorm(n=1, mean=0, sd=1)
b1 <- rnorm(n=1, mean=0, sd=1)
tau_nu <- rgamma(n=1, shape=1, scale=1)
tau_mu <- rgamma(n=1, shape=1, scale=1)
mu <- mvrnorm(n=1, mu=rep(0, nd), Sigma=diag(rep(1, nd)))
log_theta <- b0 + b1 * pennLC.sf$smoking +
get_mu(tau_mu, W, d$x, mu) + rnorm(n=nd, mean=0, sd=1/tau_nu)
y <- rpois(n=nd, lambda=exp(log_theta) * E)
df1[i, ] <- y
}
df1 <- data.frame(df1)
colnames(df1) <- pennLC.sf$county
head(df1)
# the largest 20% are trimmed to avoid extreme values
v <- sort(df1$centre, TRUE)[20:100]
hist(v[v <= 10000], main='centre', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='centre'))$counts)
v <- sort(df1$monroe, TRUE)[20:100]
hist(v[v <= 10000], main='monroe', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='monroe'))$counts)
v <- sort(df1$westmoreland)[20:100]
hist(v[v <= 10000], main='westmoreland', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='westmoreland'))$counts)
v <- sort(df1$lebanon, TRUE)[20:100]
hist(v[v <= 10000], main='lebanon', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='lebanon'))$counts)
v <- sort(df1$beaver, TRUE)[20:100]
hist(v[v <= 10000], main='beaver', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='beaver'))$counts)
v <- sort(df1$erie, TRUE)[20:100]
hist(v[v <= 10000], main='erie', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='erie'))$counts)
df2 <- matrix(nrow=100, ncol=nd)
for(i in 1:100){
b0 <- rnorm(n=1, mean=0, sd=100)
b1 <- rnorm(n=1, mean=0, sd=100)
tau_nu <- rgamma(n=1, shape=0.1, scale=0.1)
tau_mu <- rgamma(n=1, shape=0.1, scale=0.1)
mu <- mvrnorm(n=1, mu=rep(0, nd), Sigma=diag(rep(1, nd)))
log_theta <- b0 + b1 * pennLC.sf$smoking +
get_mu(tau_mu, W, d$x, mu) + rnorm(n=nd, mean=0, sd=1/tau_nu)
y <- rpois(n=nd, lambda=exp(log_theta) * E)
df2[i, ] <- y
}
# This is not a good prior since tau_mu tends to yield extreme log_theta.
# Many draws are infinitely large.
df2 <- data.frame(df2)
colnames(df2) <- pennLC.sf$county
head(df2)
hist(df2$centre, main='centre', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='centre'))$counts)
hist(df2$monroe, main='monroe', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='monroe'))$counts)
hist(df2$westmoreland, main='westmoreland', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='westmoreland'))$counts)
hist(df2$lebanon, main='lebanon', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='lebanon'))$counts)
hist(df2$beaver, main='beaver', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='beaver'))$counts)
hist(df2$erie, main='erie', xlab='y')
abline(v=(pennLC.sf %>% filter(county=='erie'))$counts)
rnorm(n=nd, mean=0, sd=1/tau_nu)
rnorm(n=nd, mean=0, sd=1/\sqrt(tau_nu))
rnorm(n=nd, mean=0, sd=1/sqrt(tau_nu))
b0 + b1 * pennLC.sf$smoking +
get_mu(tau_mu, W, d$x, mu)
rgamma(n=1, shape=0.1, scale=0.1)
rgamma(n=1, shape=0.1, scale=0.1)
rgamma(n=1, shape=0.1, scale=0.1)
rgamma(n=1, shape=0.1, scale=0.1)
rgamma(n=1, shape=0.1, scale=0.1)
rgamma(n=1, shape=0.1, scale=0.1)
rgamma(n=1, shape=0.1, scale=0.1)
source('~/GitHub/scRNA_study/test/wbs_cost.R')
getwd()
setwd("~/GitHub/scRNA_study/test")
source('~/GitHub/scRNA_study/test/wbs_cost.R')
source('~/GitHub/scRNA_study/test/wbs_cost.R')
res_ot_wbs
np$save('../results/simulation/multisetting_res_wbs.npy', prob_all)
res_ot_wbs[1,1,1][[1]][1,]
res_ot_wbs[1,1,1][[1]][2,]
res_ot_wbs[1,1,1][[1]][3,]
res_ot_wbs_ng[1,1][[1]][3,]
res_ot_wbs_ng[1,1][[1]][2,]
res_ot_wbs_ng[1,1][[1]][1,]
res_ot_wbs_ng[1,1][[1]]
res_ot_wbs_ng[2,2][[1]]
res_ot_wbs_ng
res_ot_wbs_ng[1,1][[1]]
source('~/GitHub/scRNA_study/test/wbs_cost.R')
res_ot_wbs_ng[1,1][[1]]
res_ot_wbs[1,1,1][[1]]
wbs.lsw(prob_all[1,1,1][[1]][1,,1])
source('~/GitHub/scRNA_study/test/wbs_cost.R')
wbs.lsw(prob_all[1,1,1][[1]][1,,1])
wbs.lsw(prob_all_ng[1,1][[1]][1,,1])
wbs.lsw(prob_all_ng[1,1][[1]][1,,2])
wbs.lsw(prob_all_ng[1,1][[1]][1,,3])
wbs.lsw(prob_all_ng[1,1][[1]][1,,4])
changepoints(wbs(prob_all_ng[1,1][[1]][1,,4]))
changepoints(wbs(prob_all_ng[1,1][[1]][1,,10]))
changepoints(wbs(prob_all_ng[2,2][[1]][1,,10]))
changepoints(wbs(prob_all_ng[2,2][[1]][1,,10]))$cpt.th
changepoints(wbs(prob_all_ng[2,2][[1]][1,,10]))$cpt.th[[1]]
ddd <- array(c(), dim=c(2,3,4))
ddd <- array(numeric(0), dim=c(2,3,4))
ddd
source('~/GitHub/scRNA_study/test/wbs_cost.R')
source('~/GitHub/scRNA_study/test/wbs_cost.R')
source('~/GitHub/scRNA_study/test/wbs_cost.R')
source('~/GitHub/scRNA_study/test/wbs_cost.R')
c(123,c(1,2,3),1,2,3)
c(123,c(1,2,3),1,2,3,'done')
ddd
ddd[1,1,1][[1]]
source('~/GitHub/scRNA_study/test/wbs_cost.R')
ddd <- array('start',  dim=c(2,2,2))
ddd
ddd[1,1,1][[1]] <- c(ddd[1,1,1][[1]],1)
ddd <- array(list(),  dim=c(2,2,2))
ddd[1,1,1][[1]]
ddd[1,1,1][[1]] <- c(ddd[1,1,1][[1]],1)
ddd[1,1,1][[1]]
source('~/GitHub/scRNA_study/test/wbs_cost.R')
res_ot_wbs
res_ot_wbs[1,1,1][[1]]
res_ot_wbs_ng[1,1][[1]]
source('~/GitHub/scRNA_study/test/wbs_cost.R')
source('~/GitHub/scRNA_study/test/wbs_cost.R')
res_ot_wbs
res_ot_wbs[857]
changepoints(wbs(prob_all[1,1,1][[1]][26,,1]))$cpt.th[[1]]
changepoints(wbs(prob_all[1,1,1][[1]][26,,2]))$cpt.th[[1]]
changepoints(wbs(prob_all[1,1,1][[1]][26,,3]))$cpt.th[[1]]
changepoints(wbs(prob_all[1,1,1][[1]][26,,4]))$cpt.th[[1]]
unique(c())
unique(c())-1
unique(NULL
)
c(NULL)[c(NULL)>0]
unique(c(NULL,NULL))
unique(c(NULL,NULL))>0
c(unique(c(NULL,NULL))>0,0)
NULL-1
ddd <- c(NULL,0,NULL,1)
ddd[ddd>0]
changepoints(wbs(prob_all[1,1,1][[1]][26,,1]))$cpt.th[[1]]
changepoints(wbs(prob_all[1,1,1][[1]][26,,2]))$cpt.th[[1]]
changepoints(wbs(prob_all[1,1,1][[1]][26,,3]))$cpt.th[[1]]
changepoints(wbs(prob_all[1,1,1][[1]][26,,4]))$cpt.th[[1]]
changepoints(wbs(prob_all[1,1,1][[1]][26,,5]))$cpt.th[[1]]
changepoints(wbs(prob_all[1,1,1][[1]][26,,6]))$cpt.th[[1]]
wbs(prob_all[1,1,1][[1]][26,,6])
changepoints(wbs(prob_all[1,1,1][[1]][26,,6]))
is.na(changepoints(wbs(prob_all[1,1,1][[1]][26,,6]))$cpt.th[[1]])
source('~/GitHub/scRNA_study/test/wbs_cost.R')
warnings()
source('~/GitHub/scRNA_study/test/wbs_cost.R')
res_ot_wbs
changepoints(wbs(prob_all[1,1,1][[1]][26,,6]))$cpt.th[[1]]
is.na(changepoints(wbs(prob_all[1,1,1][[1]][26,,6]))$cpt.th[[1]])
length(changepoints(wbs(prob_all[1,1,1][[1]][26,,6]))$cpt.th[[1]])
source('~/GitHub/scRNA_study/test/wbs_cost.R')
prob_all[2,1,2][[1]]
prob_all[2,1,1][[1]]
dim(prob_all)
prob_all[1,1,1][[1]]
prob_all[2,1,1][[1]][1,,]
changepoints(wbs(prob_all_ng[2,2][[1]][1,,1]))$cpt.th[[1]]
prob_all_ng[2,2][[1]][1,,1]
plot(prob_all_ng[2,2][[1]][1,,1])
changepoints(wbs(prob_all_ng[2,2][[1]][1,,1]))
changepoints(wbs(prob_all_ng[2,2][[1]][1,,5]))
changepoints(wbs(prob_all_ng[2,2][[1]][1,,5]))$cpt.th[[1]]
changepoints(wbs(prob_all_ng[2,2][[1]][1,,3]))$cpt.th[[1]]
install.packages('ecp')
library(ecp)
e.divisive(prob_all[1,1,1][[1]][1,,])
prob_all[1,1,1][[1]][1,,]
e.divisive(prob_all[1,1,1][[1]][1,,])$estimates
e.divisive(prob_all_ng[1,1][[1]][1,,])
e.divisive(prob_all_ng[1,1][[1]][10,,])
e.cp30(prob_all_ng[1,1][[1]][10,,])
e.cp3o(prob_all_ng[1,1][[1]][10,,])
e.agglo(prob_all_ng[1,1][[1]][10,,])
e.agglo(prob_all_ng[1,1][[1]][5,,])
dim(prob_all_ng[1,1][[1]][5,,])
e.agglo(prob_all_ng[1,1][[1]][5,,])
e.cp3o_delta(prob_all_ng[1,1][[1]][5,,])
e.cp3o_delta(X=prob_all_ng[1,1][[1]][5,,])
e.cp3o(prob_all_ng[1,1][[1]][5,,])
kcpa(prob_all_ng[1,1][[1]][5,,])
kcpa(prob_all_ng[1,1][[1]][5,,],L=50)
ks.cp3o(prob_all_ng[1,1][[1]][5,,],L=50)
ks.cp3o(prob_all_ng[1,1][[1]][5,,])
ks.cp3o(Z=prob_all_ng[1,1][[1]][5,,])
ks.cp3o(Z=prob_all_ng[1,1][[1]][5,,],K=50)
x = matrix(c(rnorm(100),rnorm(100,3),rnorm(100,0,2)))
y = ks.cp3o(Z=x, K=7, minsize=30, verbose=FALSE)
#View estimated change point locations
y$estimates
x
y
x
x = matrix(c(rnorm(100),rnorm(100,3),rnorm(100,0,2)))
y = ks.cp3o(Z=rbind(x,x), K=7, minsize=30, verbose=FALSE)
#View estimated change point locations
y$estimates
x = matrix(c(rnorm(100),rnorm(100,3),rnorm(100,0,2)))
y = ks.cp3o(Z=cbind(x,x), K=7, minsize=30, verbose=FALSE)
#View estimated change point locations
y$estimates
cbind(x,x)
ks.cp3o(Z=prob_all_ng[1,1][[1]][5,,],K=50)
ks.cp3o(Z=prob_all_ng[1,1][[1]][5,,1:2],K=50)
prob_all_ng[1,1][[1]][5,,1:2]
ks.cp3o_delta(Z=prob_all_ng[1,1][[1]][5,,1:2],K=50)
ks.cp3o(Z=prob_all_ng[1,1][[1]][5,,1:2])
ks.cp3o(Z=prob_all_ng[1,1][[1]][5])
ks.cp3o(Z=prob_all_ng[1,1][[1]][5,])
ks.cp3o(Z=prob_all_ng[1,1][[1]][5,,])
set.seed(100)
mem = rep(c(1,2,3,4),times=c(10,10,10,10))
x = as.matrix(c(rnorm(10,0,1),rnorm(20,2,1),rnorm(10,-1,1)))
y = e.agglo(X=x,member=mem,alpha=1,penalty=function(cp,Xts) 0)
y$estimates
e.agglo(prob_all_ng[1,1][[1]][5,,])
e.agglo(prob_all_ng[2,2][[1]][5,,])
e.agglo(prob_all_ng[2,2][[1]][10,,])
e.agglo(prob_all_ng[1,2][[1]][10,,])
e.agglo(prob_all_ng[1,1][[1]][10,,])
e.agglo(prob_all_ng[2,2][[1]][10,,])
e.divisive(prob_all_ng[2,2][[1]][10,,], min.size=1)
e.divisive(prob_all_ng[2,2][[1]][10,,], min.size=2)
e.divisive(prob_all_ng[2,2][[1]][10,,], min.size=2)
e.divisive(prob_all_ng[2,2][[1]][10,,], min.size=2)
e.divisive(prob_all[1,1,1][[1]][10,,], min.size=2)
source('~/GitHub/scRNA_study/test/wbs_cost.R')
source('~/GitHub/scRNA_study/test/wbs_cost.R')
source('~/GitHub/scRNA_study/test/wbs_cost.R')
source('~/GitHub/scRNA_study/test/wbs_cost.R')
res_ot_ecp
source('~/GitHub/scRNA_study/test/wbs_cost.R')
